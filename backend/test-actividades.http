### Variables de entorno
@baseUrl = http://localhost:4000
@token = {{login.response.body.accessToken}}

### 1. Login para obtener token
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "admin@clientpro.com",
  "password": "Password123!"
}

###############################################
# ACTIVIDADES - CRUD COMPLETO
###############################################

### 2. Crear actividad - Llamada de seguimiento
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "LLAMADA",
  "titulo": "Llamada de seguimiento mensual",
  "descripcion": "Revisar avances del proyecto CRM",
  "fechaVencimiento": "2026-01-25T10:00:00Z",
  "clienteId": "c1111111-1111-1111-1111-111111111111"
}

### 3. Crear actividad - Reunión con negocio
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "REUNION",
  "titulo": "Demo del producto",
  "descripcion": "Presentación del CRM al equipo de TI",
  "fechaVencimiento": "2026-01-22T14:00:00Z",
  "negocioId": "n1111111-1111-1111-1111-111111111111"
}

### 4. Crear actividad - Email sin fecha límite
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "EMAIL",
  "titulo": "Enviar propuesta comercial",
  "descripcion": "Propuesta económica para licencias anuales",
  "clienteId": "c1111111-1111-1111-1111-111111111111"
}

### 5. Crear actividad - Tarea asignada a otro usuario
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "TAREA",
  "titulo": "Preparar documentación técnica",
  "descripcion": "Manual de usuario y guía de instalación",
  "fechaVencimiento": "2026-01-30T17:00:00Z",
  "negocioId": "n1111111-1111-1111-1111-111111111111",
  "asignadoA": "u2222222-2222-2222-2222-222222222222"
}

### 6. Listar actividades (paginación)
GET {{baseUrl}}/actividades?page=1&limit=10
Authorization: Bearer {{token}}

### 7. Listar actividades - Búsqueda por texto
GET {{baseUrl}}/actividades?search=demo
Authorization: Bearer {{token}}

### 8. Listar actividades - Filtrar por tipo
GET {{baseUrl}}/actividades?tipo=LLAMADA
Authorization: Bearer {{token}}

### 9. Listar actividades - Filtrar por completadas
GET {{baseUrl}}/actividades?completada=false
Authorization: Bearer {{token}}

### 10. Listar actividades - Filtrar por asignado
GET {{baseUrl}}/actividades?asignadoA=u1111111-1111-1111-1111-111111111111
Authorization: Bearer {{token}}

### 11. Obtener actividad por ID (reemplazar con ID real)
@actividadId = a1111111-1111-1111-1111-111111111111
GET {{baseUrl}}/actividades/{{actividadId}}
Authorization: Bearer {{token}}

### 12. Actualizar actividad
PATCH {{baseUrl}}/actividades/{{actividadId}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "titulo": "Llamada de seguimiento URGENTE",
  "fechaVencimiento": "2026-01-20T09:00:00Z"
}

### 13. Marcar actividad como completada
PATCH {{baseUrl}}/actividades/{{actividadId}}/completar
Authorization: Bearer {{token}}

### 14. Eliminar actividad
DELETE {{baseUrl}}/actividades/{{actividadId}}
Authorization: Bearer {{token}}

###############################################
# PRUEBAS DE VALIDACIÓN
###############################################

### 15. Error: Crear sin negocio ni cliente
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "TAREA",
  "titulo": "Actividad sin relación"
}

### 16. Error: Tipo inválido
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "TIPO_INVALIDO",
  "titulo": "Test tipo inválido",
  "clienteId": "c1111111-1111-1111-1111-111111111111"
}

### 17. Error: Cliente inexistente
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "LLAMADA",
  "titulo": "Test cliente no existe",
  "clienteId": "00000000-0000-0000-0000-000000000000"
}

### 18. Error: Negocio inexistente
POST {{baseUrl}}/actividades
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "tipo": "REUNION",
  "titulo": "Test negocio no existe",
  "negocioId": "00000000-0000-0000-0000-000000000000"
}
